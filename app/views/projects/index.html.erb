<p id="notice"><%= notice %></p>

<h1>Listing Projects</h1>
<h2>Total Projects: <%= @projects.count %></h2>
<h3>Your Clients: <%= current_user.clients.count %></h3>

<!-- ADVANCED FILTER -->
<div class="alert alert-info form-group form-inline">
<%= form_tag projects_path, :method => 'get' do %>
  <strong style="padding-right: 50px;">Filter your results:</strong>
    <%= text_field_tag :search, params[:search] %>
    <%= submit_tag "Search", class: 'btn btn-secondary' %>
<% end %>
</div>

<table class="table">
  <thead>
    <tr>
      <th>Client</th>
      <th>Project status</th>
      <th>Project status</th>
      <th>Project name</th>
      <th>Completion date</th>
      <th>Completion month</th>
      <th>Budget revenue</th>
      <th>Budget margin</th>
      <th>Budget margin %</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody> 
    <% @myprojects.each do |project| %>
      <tr>
        <td><%= project.client %></td>
        <td><%= project.project_status %></td>
        <td><%= project.project_status %></td>
        <td><%= project.project_name %></td>
        <td><%= project.completion_date %></td>
        <td><%= project.completion_month %></td>
        <td><%= project.budget_revenue %></td>
        <td><%= project.budget_margin %></td>
        <td><%= project.budget_margin_pct %>%</td>
        <td><%= link_to 'Show', project %></td>
        <td><%= link_to 'Edit', edit_project_path(project) %></td>
        <td><%= link_to 'Destroy', project, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>
<h3>Upload Database</h3>
<%= form_tag('/projects/import/', multipart: true) do %>
  <%= file_field_tag :file %>
  <%= submit_tag 'Upload', class: 'btn btn-default'%>
<% end %>
<br><br>
<div class="btn-group">
  <button type="button" class="btn btn-secondary dropdown-toggle"
          data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Delete All...
  </button>
  <div class="dropdown-menu">
    <%= link_to 'Delete all', delete_all_path, method: :delete, data: { confirm: 'Are you sure?' }, class: 'dropdown-item' %>
  </div>
</div>
<br><br>
<%= link_to 'New Project', new_project_path, class: 'btn btn-default' %>

